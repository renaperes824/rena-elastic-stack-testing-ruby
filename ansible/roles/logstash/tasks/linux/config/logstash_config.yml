#-----------------------------------------------------------------------------------------------------------------------
# Configure logstash on Linux
#
# Set certain parameters in logstash configuration
#
# Author: liza.dayoub@elastic.co
#-----------------------------------------------------------------------------------------------------------------------

---

- name: Add network host
  lineinfile:
    path: '{{ logstash_config_file }}'
    insertafter: '^#server.host:'
    line: 'server.host: {{ network_host }}'
  become: '{{ logstash_run_as_root | default(omit) }}'
  when: network_host is defined

- name: Add logging
  lineinfile:
    path: "{{ logstash_config_file }}"
    insertafter: '^#logging.dest:'
    line: 'logging.dest: {{ logstash_log_file | trim }}'
  become: '{{ logstash_run_as_root | default(omit) }}'

- name: Create log directory
  file:
    path: '{{ logstash_log_dir }}'
    state: directory
    mode: 0777
  become: true
  tags: logstash_log_check
