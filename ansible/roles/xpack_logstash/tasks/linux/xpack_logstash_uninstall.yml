#----------------------------------------------------------------------------------------------------------------------
# Install kibana .tar package
#
# Author: liza.dayoub@elastic.co
#
#----------------------------------------------------------------------------------------------------------------------

---

- name: Get Logstash X-Pack Plugins
  shell: "{{ logstash_plugin_exe }} list"
  register: list_plugins_before

- name: Uninstall Logstash X-Pack
  shell: '{{ logstash_plugin_exe }} remove x-pack'
  register: output
  when: '"x-pack" in list_plugins_before.stdout_lines'

- name: Get Logstash X-Pack Plugins
  shell: "{{ logstash_plugin_exe }} list"
  register: list_plugins_after
- name: Fail If X-Pack Logstash Is Installed
  fail:
  when: '"x-pack" in list_plugins_after.stdout_lines'
