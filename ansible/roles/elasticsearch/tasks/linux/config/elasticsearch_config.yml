#-----------------------------------------------------------------------------------------------------------------------
# Configure elasticsearch on Linux
#
# Set certain parameters in elasticsearch configuration
#
# Author: liza.dayoub@elastic.co
#-----------------------------------------------------------------------------------------------------------------------

---

- name: Add network host
  lineinfile:
    path: '{{ elasticsearch_config_file }}'
    insertafter: '^#network.host:'
    line: 'network.host: {{ network_host }}'
  become: '{{ elasticsearch_run_as_root | default(omit) }}'
  when: network_host is defined

- name: Add zen ping unicast hosts
  lineinfile:
    path: ' {{ elasticsearch_config_file }}'
    insertafter: '^#discovery.zen.ping.unicast.hosts:'
    line: 'discovery.zen.ping.unicast.hosts: {{ host_ip_list }}'
  become: '{{ elasticsearch_run_as_root | default(omit) }}'
  when: nodes_in_cluster|int > 1

- name: Add zen minimum master nodes
  lineinfile:
    path: '{{ elasticsearch_config_file }}'
    insertafter: '^#discovery.zen.minimum_master_nodes:'
    line: 'discovery.zen.minimum_master_nodes: {{ nodes_in_cluster }}'
  become: '{{ elasticsearch_run_as_root | default(omit) }}'
  when: nodes_in_cluster|int > 1
